<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>VSABrains Narrative Demo</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600&family=Fraunces:wght@500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="app">
      <header class="topbar">
        <div class="brand">
          <div class="brand-mark">VSA</div>
          <div>
            <div class="brand-title">VSABrains</div>
            <div class="brand-subtitle">Narrative Trajectory Demo</div>
          </div>
        </div>
        <div class="topbar-actions">
          <button class="btn ghost" id="resetBtn">Reset Scene</button>
          <button class="btn ghost" id="randomBtn">Add Random Event</button>
        </div>
      </header>

      <main class="grid">
        <section class="panel builder">
          <h2>Story Builder</h2>
          <p class="muted">Compose events. The system writes them into a spatial memory trajectory.</p>

          <div class="field">
            <label for="subjectSelect">Subject</label>
            <select id="subjectSelect"></select>
            <div class="hint">Choose a character or <span class="inline-tag">P</span> for coreference.</div>
          </div>

          <div class="field">
            <label for="actionSelect">Action</label>
            <select id="actionSelect"></select>
          </div>

          <div class="field" id="objectField">
            <label for="objectSelect" id="objectLabel">Object</label>
            <select id="objectSelect"></select>
          </div>

          <button class="btn primary" id="addEventBtn">Add Event</button>
          <div class="status" id="statusMsg"></div>

          <div class="divider"></div>

          <h3>Telemetry</h3>
          <div class="telemetry">
            <div>
              <span class="label">Step</span>
              <span class="value" id="stepValue">0</span>
            </div>
            <div>
              <span class="label">Agreement</span>
              <span class="value" id="agreementValue">0.00</span>
            </div>
            <div>
              <span class="label">Grid Util</span>
              <span class="value" id="utilValue">0.00</span>
            </div>
            <div>
              <span class="label">Cell Saturation</span>
              <span class="value" id="satValue">0.00</span>
            </div>
            <div>
              <span class="label">Localizer Top</span>
              <span class="value" id="localizeValue">—</span>
            </div>
          </div>
        </section>

        <section class="panel viz">
          <div class="viz-header">
            <h2>Memory Grid</h2>
            <div class="legend">
              <span class="legend-dot dot-1"></span> Column 1
              <span class="legend-dot dot-2"></span> Column 2
              <span class="legend-dot dot-3"></span> Column 3
            </div>
          </div>
          <div class="canvas-wrap">
            <canvas id="gridCanvas" width="640" height="640"></canvas>
          </div>
          <div class="scrub">
            <input type="range" id="scrubRange" min="0" max="0" value="0" />
            <div class="scrub-labels">
              <span id="scrubStart">0</span>
              <span id="scrubEnd">0</span>
            </div>
          </div>
        </section>

        <section class="panel timeline">
          <h2>Timeline</h2>
          <ul id="timelineList"></ul>
        </section>

        <section class="panel query">
          <h2>Query</h2>
          <p class="muted">Ask about the current scene state. Answers are replayed from events.</p>

          <div class="field">
            <label for="queryType">Query Type</label>
            <select id="queryType">
              <option value="where">Where is an entity?</option>
              <option value="inventory">What does an entity have?</option>
              <option value="whoHas">Who has an item?</option>
              <option value="alive">Is an entity alive?</option>
            </select>
          </div>

          <div class="field" id="queryEntityField">
            <label for="queryEntity">Entity</label>
            <select id="queryEntity"></select>
          </div>

          <div class="field" id="queryItemField">
            <label for="queryItem">Item</label>
            <select id="queryItem"></select>
          </div>

          <button class="btn primary" id="queryBtn">Run Query</button>

          <div class="answer" id="answerBox">
            <div class="answer-title">Answer</div>
            <div class="answer-body" id="answerText">—</div>
            <div class="answer-verdict" id="answerVerdict">—</div>
          </div>

          <div class="evidence">
            <div class="answer-title">Evidence Trail</div>
            <ul id="evidenceList"></ul>
          </div>
        </section>
      </main>
    </div>

    <script type="module" src="app.js"></script>
  </body>
</html>
